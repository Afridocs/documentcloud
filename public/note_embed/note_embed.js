(function(){window.dc=window.dc||{};dc.embed=dc.embed||{};var e=dc.embed.notes=dc.embed.notes||{},g=dc._=window._.noConflict(),f=dc.jQuery=window.jQuery.noConflict(true);dc.embed.loadNote=function(a,b){var c=b.note_id;e[c]=e[c]||{};e[c].options=b;c="/documents/"+encodeURIComponent(b.document_id)+"/annotations/"+encodeURIComponent(b.note_id)+".js";f.getScript(a+c)};dc.embed.noteCallback=function(a){var b=a.id;a=new dc.embed.noteModel(a);var c=f("#DC-note-"+b),d=c.width();if(b=e[b].options.container)c=
f(b);c.html(JST.note_embed({note:a}));d<700&&a.center(c,d)};dc.embed.noteModel=function(a){this.attributes=a};dc.embed.noteModel.prototype={get:function(a){return this.attributes[a]},option:function(a){return dc.embed.notes[this.get("id")].options[a]},imageUrl:function(){return this._imageUrl=this._imageUrl||this.get("image_url").replace("{size}","normal").replace("{page}",this.get("page"))},coordinates:function(){if(this._coordinates)return this._coordinates;var a=this.get("location");if(!a)return null;
a=g.map(a.image.split(","),function(b){return parseInt(b,10)});return this._coordinates={top:a[0],left:a[3],right:a[1],height:a[2]-a[0],width:a[1]-a[3]}},center:function(a){a=f(".DC-note-excerpt",a);var b=this._coordinates,c=b.left+b.width/2,d=a.closest(".DC-note-excerpt-wrap").width(),h=d/2;if(b.left+b.width>d)b.width>d?a.css("left",-1*b.left):a.css("left",h-c)},viewerUrl:function(){var a="#document/p"+this.get("page")+"/a"+this.get("id");return this.get("published_url")+a}}})();
(function(){window.JST=window.JST||{};window.JST.note_embed=dc._.template('<div class="DC-note">  <div class="DC-note-contents">    <div class="DC-note-title display">      <a class="DC-title-link" href="<%= note.viewerUrl() %>"><%= note.get(\'title\') %> <span class="DC-page-number">(p. <%= note.get(\'page\') %>)</span></a>    </div>    <% if (note.get(\'access\') == \'exclusive\') { %>      <div class="DC-note-draft-label interface display">Draft</div>    <% } %>      <% if (note.get(\'access\') == \'private\') { %>      <div class="DC-icon lock display" title="Private note"></div>    <% } %>    <% var coords = note.coordinates(); %>    <% if (coords) { %>      <a href="<%= note.viewerUrl() %>">        <div class="DC-note-excerpt-wrap">          <div class="DC-note-excerpt" style="height: <%= coords.height %>px;">            <div class="DC-left-cover"  style="height: <%= coords.height %>px; width: <%= coords.left %>px;"></div>            <div class="DC-right-cover" style="height: <%= coords.height %>px; width: <%= 750 - coords.right %>px;"></div>            <img class="DC-note-image" src="<%= note.imageUrl() %>" alt="" style="top: -<%= coords.top %>px;" />          </div>        </div>      </a>    <% } %>    <div class="DC-note-text display"><%= note.get(\'content\') %></div>  </div></div>')})();
